#!/usr/bin/env bash


usage() {
  echo "usage: $(basename $0)"
}

if [[ -z $(which initdb) ]] ; then
  echo 'Postres not detected.'
  exit 1
fi

if ! [[ -d ./db ]] ; then
  initdb -D ./db
else
  echo './db directory already exists; skipping initdb.'
fi

if ! [[ -f ./db/postmaster.pid ]] ; then
  pg_ctl -D ./db -o "--unix-socket-directories='$PWD'" start
else
  echo './db/postmaster.pid detected; assuming the server is already running.'
fi

echo 'Creating role...'
createuser --host=localhost rtc

echo 'Creating database...'
createdb --host=localhost --owner=rtc rtc
